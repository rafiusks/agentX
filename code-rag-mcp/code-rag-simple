#!/bin/bash
# Simple Code RAG wrapper for current project

# Build if needed
if [ ! -f ".code-rag/code-rag" ]; then
    echo "Building Code RAG..."
    go build -o .code-rag/code-rag cmd/code-rag/main.go 2>/dev/null || {
        echo "Error: Go is required to build Code RAG"
        exit 1
    }
fi

# Ensure config exists
if [ ! -f ".code-rag/config.json" ]; then
    mkdir -p .code-rag
    cat > .code-rag/config.json << EOF
{
  "project_path": "$(pwd)",
  "project_name": "$(basename $(pwd))",
  "indexed": false
}
EOF
fi

# Run Code RAG
exec .code-rag/code-rag "$@"