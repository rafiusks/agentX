/* Chat-specific styles for improved readability */

@layer components {
  /* Message bubbles */
  .message-user {
    @apply bg-blue-500/[0.08] text-foreground-primary;
    @apply border border-blue-500/[0.12];
    @apply rounded-2xl px-6 py-5; /* More internal padding */
    @apply text-[16px]; /* Slightly larger for better readability */
    @apply max-w-[680px];
    @apply transition-all duration-200;
    line-height: 1.75;
    letter-spacing: 0.012em;
  }
  
  .message-user:hover {
    @apply bg-blue-500/[0.10] border-blue-500/[0.16];
  }
  
  .message-assistant {
    @apply bg-background-secondary;
    @apply border border-border-subtle/50;
    @apply rounded-2xl px-6 py-5; /* Consistent padding with user messages */
    @apply shadow-sm;
    @apply max-w-[680px];
    @apply transition-all duration-200;
  }
  
  .message-assistant:hover {
    @apply shadow-md border-border-subtle/70;
  }
  
  .message-function {
    @apply bg-amber-500/[0.05];
    @apply border border-amber-500/[0.10];
    @apply rounded-2xl px-5 py-4;
    @apply max-w-[680px];
  }
  
  /* Message content typography - optimized for reading */
  .message-content {
    @apply text-[16px] text-foreground-primary; /* Increased from 15px */
    line-height: 1.85; /* More generous line height for better readability */
    letter-spacing: 0.02em; /* Subtle letter spacing for clarity */
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }
  
  .message-content-user {
    @apply text-[16px] whitespace-pre-wrap break-words; /* Match assistant font size */
    line-height: 1.75; /* Comfortable line height for user messages */
    letter-spacing: 0.015em; /* Slightly tighter for user messages */
    -webkit-font-smoothing: antialiased;
  }
  
  /* Code blocks within messages */
  .message-code-block {
    @apply bg-gray-900/50 border border-gray-800;
    @apply rounded-xl p-4 my-4;
    @apply overflow-x-auto;
    @apply relative;
  }
  
  .message-code-block pre {
    @apply text-[14px] font-mono; /* Slightly larger for better readability */
    line-height: 1.65; /* More generous line height for code */
    letter-spacing: 0.02em; /* Slight letter spacing for mono fonts */
  }
  
  .message-inline-code {
    @apply bg-gray-900/30 text-blue-400;
    @apply px-1.5 py-0.5 rounded-md;
    @apply text-[14px] font-mono;
    letter-spacing: 0.015em;
  }
  
  /* Enhanced prose styles for assistant messages - optimized for readability */
  .prose-chat {
    @apply text-[16px] max-w-none; /* Increased for better readability */
    line-height: 1.9; /* Very generous line height for long-form reading */
    letter-spacing: 0.02em; /* Optimal letter spacing for extended reading */
    word-spacing: 0.08em; /* Subtle word spacing improvement */
    -webkit-font-smoothing: antialiased;
    text-rendering: optimizeLegibility;
  }
  
  .prose-chat h1 {
    @apply text-xl font-semibold mt-6 mb-4 text-foreground-primary;
    letter-spacing: -0.01em; /* Tighter for headers */
    line-height: 1.3;
  }
  
  .prose-chat h2 {
    @apply text-lg font-semibold mt-5 mb-3 text-foreground-primary;
    letter-spacing: -0.008em;
    line-height: 1.35;
  }
  
  .prose-chat h3 {
    @apply text-base font-semibold mt-4 mb-2.5 text-foreground-primary;
    letter-spacing: -0.005em;
    line-height: 1.4;
  }
  
  .prose-chat p {
    @apply mb-5; /* More breathing room between paragraphs */
    color: rgba(255, 255, 255, 0.92); /* Slightly softer than pure white for extended reading */
    line-height: inherit;
    letter-spacing: inherit;
  }
  
  .prose-chat ul {
    @apply mb-5 ml-4 space-y-2.5; /* More space between list items */
    line-height: inherit;
  }
  
  .prose-chat ol {
    @apply mb-5 ml-4 space-y-2.5;
    line-height: inherit;
  }
  
  .prose-chat li {
    @apply pl-2;
  }
  
  .prose-chat ul li::before {
    content: "â€¢";
    @apply text-foreground-muted mr-2 font-bold;
  }
  
  .prose-chat ol {
    counter-reset: list-counter;
  }
  
  .prose-chat ol li {
    counter-increment: list-counter;
    @apply relative pl-6;
  }
  
  .prose-chat ol li::before {
    content: counter(list-counter) ".";
    @apply absolute left-0 text-foreground-secondary font-medium;
  }
  
  .prose-chat blockquote {
    @apply border-l-4 border-accent-blue/30;
    @apply pl-4 py-2 my-4;
    @apply bg-accent-blue/[0.03];
    @apply italic text-foreground-secondary;
  }
  
  .prose-chat hr {
    @apply my-6 border-border-subtle/30;
  }
  
  .prose-chat strong {
    @apply font-semibold text-foreground-primary;
  }
  
  .prose-chat em {
    @apply italic;
  }
  
  .prose-chat a {
    @apply text-accent-blue hover:text-accent-blue/80;
    @apply underline underline-offset-2 transition-colors;
  }
  
  /* Table styles */
  .prose-chat table {
    @apply w-full my-4 border-collapse;
  }
  
  .prose-chat th {
    @apply bg-background-tertiary/50 px-4 py-2;
    @apply text-left font-semibold text-foreground-primary;
    @apply border border-border-subtle/50;
  }
  
  .prose-chat td {
    @apply px-4 py-2;
    @apply border border-border-subtle/30;
  }
  
  .prose-chat tr:nth-child(even) {
    @apply bg-background-secondary/30;
  }
  
  /* Message animations */
  @keyframes message-fade-in {
    from {
      opacity: 0;
      transform: translateY(10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  
  .message-animate-in {
    animation: message-fade-in 0.3s ease-out;
  }
  
  /* Avatar styles */
  .message-avatar {
    @apply w-8 h-8 rounded-xl flex-shrink-0;
    @apply flex items-center justify-center;
    @apply transition-transform duration-200;
  }
  
  .message-avatar:hover {
    @apply scale-110;
  }
  
  /* Copy button for code blocks */
  .code-copy-button {
    @apply absolute top-2 right-2;
    @apply px-2 py-1 rounded-md;
    @apply bg-gray-800 text-gray-300;
    @apply text-xs font-medium;
    @apply transition-opacity duration-200;
    @apply hover:bg-gray-700 hover:text-white;
  }
  
  .message-code-block:hover .code-copy-button {
    @apply opacity-100;
  }
  
  /* Language badge for code blocks */
  .code-language-badge {
    @apply absolute top-2 left-2;
    @apply px-2 py-0.5 rounded-md;
    @apply bg-gray-800/70 text-gray-400;
    @apply text-xs font-mono;
  }
}

/* Smooth scrolling for chat */
@layer utilities {
  .chat-scroll-smooth {
    scroll-behavior: smooth;
    scrollbar-gutter: stable;
  }
  
  .chat-container {
    @apply flex-1 overflow-y-auto;
    @apply px-4 sm:px-6 py-6;
  }
  
  .chat-messages-wrapper {
    @apply max-w-4xl mx-auto;
    @apply space-y-8; /* Increased from space-y-6 */
  }
}

/* Typing Indicator Animation */
@keyframes typing-pulse {
  0%, 60%, 100% {
    opacity: 0.3;
    transform: scale(1);
  }
  30% {
    opacity: 1;
    transform: scale(1.15);
  }
}

.typing-dot {
  display: inline-block;
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background-color: currentColor;
  opacity: 0.3;
  animation: typing-pulse 1.4s infinite;
}